#cloud-config
# Cloud-init configuration for NVIDIA Air BCM deployment
# SSH_PUBLIC_KEY from .env replaces YOUR_SSH_PUBLIC_KEY_HERE
# {PASSWORD} is replaced at runtime by the deploy script

chpasswd:
  users:
    - name: root
      password: "{PASSWORD}"
      type: text
    - name: ubuntu
      password: "{PASSWORD}"
      type: text
  expire: false

ssh_pwauth: true

ssh_authorized_keys:
  - YOUR_SSH_PUBLIC_KEY_HERE

runcmd:
  - mkdir -p /root/.ssh
  - chmod 700 /root/.ssh
  - echo "YOUR_SSH_PUBLIC_KEY_HERE" >> /root/.ssh/authorized_keys
  - chmod 600 /root/.ssh/authorized_keys
  - sed -i 's/^#*PermitRootLogin.*/PermitRootLogin yes/' /etc/ssh/sshd_config
  - systemctl restart sshd
  - ip link set eth0 up
  - ip link set eth1 up
  - ip link set eth2 up
  - ip link set eth4 up
  - sleep 2
